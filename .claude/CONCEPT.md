# sid-fret プロジェクト構想

## プロジェクトのビジョン

sid-fretは、ベースギター演奏に特化した音楽理論ライブラリです。既存の汎用音楽理論ライブラリでは対応しきれない、ベース特有の運指計算や演奏最適化を提供します。

## 開発の背景

### 元プロジェクト: sid-note
- **リポジトリ**: kako-jun/sid-note
- **構成**: Next.js (TypeScript) + rust-music (WASM)
- **目的**: TAB譜よりも具体的な運指ガイダンスを提供
- **課題**: TypeScript実装にenharmonic判定のバグがあり、Rust移行を決定

### sid-fretの立ち位置
sid-noteから**ライブラリ部分を抽出**し、独立したRust/WASMライブラリとして再構築。

## 設計方針

### 1. 車輪の再発明を避ける
- **rust-music-theory**: 基本的な音楽理論（Note, Chord, Scale, Interval）は依存
- **kordには依存しない**: シンプルな依存構成を維持
- **独自実装する領域**: 既存ライブラリにない機能のみ

### 2. ベース特化
- 4弦ベース標準チューニング（E1, A1, D2, G2）
- ベース固有の運指パターン
- ベースらしい演奏スタイルの最適化

### 3. 柔軟なアルゴリズム選択
ジャンルやスキルレベルに応じて運指アルゴリズムを選択可能：
- 初心者: 開放弦活用、ポジション固定
- 中級者: 最短移動、バランス型
- 上級者: 弦移動優先、カスタム重み付け

## コア機能

### 1. ベース特化フレット計算
- 音程 → フレットポジション変換
- 4弦マッピング
- オクターブ展開（4オクターブ範囲）

### 2. 運指アルゴリズム（5種類）

#### a. 最短移動 (shortest)
- **目的**: フレット移動距離を最小化
- **用途**: 速いテンポの曲、シンプルな演奏

#### b. ポジション固定 (position-stable)
- **目的**: 特定ポジション内で演奏を完結
- **用途**: フォームの安定性重視、初心者向け

#### c. 弦移動優先 (string-priority)
- **目的**: 横移動より縦移動を優先
- **用途**: ベースの特性を活かした自然な運指

#### d. 開放弦活用 (open-string)
- **目的**: 開放弦を積極的に使用
- **用途**: ルート音強調、ポジション移動削減

#### e. バランス型 (balanced)
- **目的**: 複数要素をスコアリングして最適化
- **用途**: 汎用的な演奏、自動選択

### 3. 機能和声・カデンツ分析
既存ライブラリにない高度な和声分析：
- I-VII度数判定
- 5種類のカデンツ検出
- ローマ数字記譜

### 4. 日本語記譜対応
- 全角シャープ（＃）/フラット（♭）対応
- コード名エイリアス（Cmaj7 ⇔ CM7 ⇔ C△7）

## 将来の拡張

### Phase 2: 高度な運指最適化
- スライド優先アルゴリズム
- フレーズ指向（グループ化）アルゴリズム
- 指の負担分散アルゴリズム
- 機械学習による運指予測

### Phase 3: 多様な楽器対応
- 5弦ベース対応
- 6弦ベース対応
- カスタムチューニング対応
- フレットレスベース対応

### Phase 4: 演奏支援機能
- リアルタイム運指提案
- 練習パターン生成
- 運指難易度評価
- 演奏動画生成

## 技術的な特徴

### Rust + WebAssembly
- **高速**: 音楽理論計算の高速化
- **型安全**: コンパイル時エラー検出
- **ポータブル**: Web、Node.js、ネイティブ対応

### モジュール構成
```
sid-fret/
├── chord/      - ベースフレット計算
├── fingering/  - 運指アルゴリズム
├── harmony/    - 機能和声分析
├── utils/      - 日本語記譜ユーティリティ
├── core/       - rust-music-theoryへの委譲
└── scale/      - rust-music-theoryへの委譲
```

### 3層アーキテクチャ
1. **楽器固有層** (fingering, chord): フレットボードマッピング
2. **記譜層** (core, scale): 音符、コード、スケール
3. **理論拡張層** (harmony, utils): 和声分析、ユーティリティ

## ライセンス・公開方針

- **ライセンス**: MIT
- **公開先**: crates.io, npm (WASM)
- **ドキュメント**: docs.rs, GitHub Pages

## 開発チーム

- **作者**: kako-jun
- **AI協力**: Claude (Anthropic)
